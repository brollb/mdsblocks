<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">

    <script src="blockly/blockly_uncompressed.js"></script>
    <script src="blockly/blocks_compressed.js"></script>
    <script src="blockly/msg/js/en.js"></script>
    <script src="blockly/generators/python.js"></script>
    <script src="blockly/generators/python/text.js"></script>
    <script src="blockly/generators/python/math.js"></script>
    
    <!-- Hiding my oauth token -->
    <script src="src/oauth_token.js"></script>

    <script src="src/lib/js-yaml.min.js"></script>
    <script src="src/lib/ramda.min.js"></script>
    <script src="src/lib/async.js"></script>
    <script src="src/lib/octokat.js"></script>
    <script src="src/utils.js"></script>

    <script src="src/metaMDS_block_creation.js"></script>
    <script src="src/concept_loader.js"></script>
    <script src="src/github_loader.js"></script>
    <script src="src/code_editor.js"></script>
    <script src="src/mds_editor.js"></script>
    <script src="src/lib/example_concepts/yaml_concepts.js"></script>

    <!-- Codemirror -->
    <link rel="stylesheet" href="src/css/codemirror.css">
    <script src="src/lib/codemirror.js"></script>
    <script src="src/lib/vim.js"></script>
    <script src="src/lib/yaml.js"></script>

    <script src="//code.jquery.com/jquery-2.1.3.js"></script>
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-material-design/0.3.0/css/roboto.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-material-design/0.3.0/css/material-fullpalette.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-material-design/0.3.0/css/ripples.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-material-design/0.3.0/js/ripples.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/noUiSlider/6.2.0/jquery.nouislider.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-material-design/0.3.0/js/material.min.js"></script>
    <style>
      html, body {
        background-color: #fff;
        margin: 0;
        padding: 0;
        overflow: hidden;
        height: 100%;
      }
      .blocklySvg {
        height: 100%;
        width: 100%;
      }

      #toolbox-container {
          float: left;
          height: 100%;
          width: 50%;
      }

      #editor-container {
        background: gray;

        float: left;
        position: absolute;
        height: 100%;
        width: 50%;
      }
    </style>
    <script>
      var yaml = jsyaml;
      function init() {
          var editor = new MDSEditor();

          // Download, Save buttons
          document.getElementById('download').onclick = editor.downloadActiveWorkspace.bind(editor);
          document.getElementById('save').onclick = editor.saveProject.bind(editor);
          document.getElementById('toggle-editor').onclick = editor.toggleCodeEditor.bind(editor);

          // Update the layout on resize
          var editorContainer = document.getElementById('editor-container'),
              toolboxContainer = document.getElementById('toolbox-container');

          var updateLayout = function() {
              // Get width, left
              var rect = toolboxContainer.getBoundingClientRect(),
                  pos = rect.left + rect.width;

              // Set left of editorContainer
              editorContainer.style.left = pos+'px';

              // Fix the height, width
              // TODO
          };
          window.onresize = updateLayout;
      }
    </script>
  </head>
  <body onload="init()">
      <div id="workspace-container" class="btn-group btn-group-justified">
          <a href="javascript:void(0)" class="btn btn-default">Loading...</a>
      </div>
      <div class="container-fluid" style="height:90%">
      <div class="row" style="height:100%">

          <div id="tag-container" class="btn-group-vertical col-md-1">
              <a href="javascript:void(0)" class="btn btn-default">Loading...</a>
          </div>
          <div id='working-container' style="height:100%;width:100%">
              <div class="col-md-4" id="toolbox-container"></div>
              <textarea class="col-md-4" id="editor-container"></textarea>
          </div>
      </div>
      </div>
    <xml id="toolbox" style="display: none"></xml>
    <div id="tag-container"></div>
    <div class="pull-right">
        <a id="toggle-editor" href="javascript:void(0)" class="btn btn-success">Edit Text</a>
        <a id="download" href="javascript:void(0)" class="btn btn-success">Download YAML</a>
        <a id="save" href="javascript:void(0)" class="btn btn-success">Commit</a>
    </div>
  </body>
  <!-- Download button -->
</html>
